{
  "projectMeta": {
    "name": "PhotoCleaner",
    "description": "사진첩의 문제 있는 사진(다운로드 실패, 중복, 손상 등)을 감지하고 제거/수정할 수 있는 iOS 앱",
    "version": "1.0.0",
    "startDate": "2026-01-01",
    "lastUpdated": "2026-01-04",
    "techStack": [
      "Swift 6",
      "SwiftUI",
      "Swift Concurrency",
      "PhotoKit",
      "Vision"
    ],
    "repository": "https://github.com/oozoofrog/PhotoCleaner",
    "bundleId": "com.oozoofrog.app.PhotoCleaner"
  },
  "currentStatus": {
    "phase": "development",
    "activeFeature": null,
    "lastSession": {
      "date": "2026-01-04",
      "summary": "사진 상세 화면 구현 - PhotoDetailView, PhotoMetadataSheet, IssueListView 네비게이션",
      "nextSteps": [
        "AllPhotosView에서 상세 화면 네비게이션 추가",
        "메타데이터 기반 중복 감지 (task-008, 선택적)",
        "자동 검사 기능"
      ]
    },
    "blockers": []
  },
  "features": [
    {
      "id": "feature-001",
      "name": "사진첩 접근 및 표시",
      "description": "PhotoKit을 사용하여 사진첩에 접근하고 사진 목록을 표시",
      "status": "completed",
      "priority": "high",
      "dependencies": [],
      "tasks": [
        {
          "id": "task-001",
          "description": "Photos 권한 요청 및 처리",
          "status": "completed",
          "assignedDate": "2026-01-02",
          "completedDate": "2026-01-02"
        },
        {
          "id": "task-002",
          "description": "PHAsset 목록 조회 서비스 구현",
          "status": "completed",
          "assignedDate": "2026-01-02",
          "completedDate": "2026-01-02"
        },
        {
          "id": "task-003",
          "description": "사진 그리드 UI 구현",
          "status": "completed",
          "assignedDate": "2026-01-03",
          "completedDate": "2026-01-03"
        }
      ],
      "notes": "PhotoPermissionService, PhotoScanService, AllPhotosView 구현 완료. 대시보드에서 전체 사진으로 이동 가능"
    },
    {
      "id": "feature-002",
      "name": "문제 사진 감지",
      "description": "다운로드 실패, 손상, iCloud 동기화 문제가 있는 사진 감지",
      "status": "completed",
      "priority": "high",
      "dependencies": ["feature-001"],
      "tasks": [
        {
          "id": "task-004",
          "description": "iCloud 다운로드 상태 확인 로직",
          "status": "completed",
          "assignedDate": "2026-01-02",
          "completedDate": "2026-01-02"
        },
        {
          "id": "task-005",
          "description": "손상된 이미지 감지 로직",
          "status": "completed",
          "assignedDate": "2026-01-02",
          "completedDate": "2026-01-02"
        },
        {
          "id": "task-006",
          "description": "문제 사진 목록 UI 표시",
          "status": "completed",
          "assignedDate": "2026-01-02",
          "completedDate": "2026-01-02"
        }
      ],
      "notes": "PhotoScanService에서 detectDownloadFailure, detectCorruption 구현. IssueListView로 목록 표시"
    },
    {
      "id": "feature-003",
      "name": "중복 사진 감지",
      "description": "동일하거나 유사한 사진을 감지하여 정리",
      "status": "completed",
      "priority": "medium",
      "dependencies": ["feature-001"],
      "tasks": [
        {
          "id": "task-007",
          "description": "이미지 해시 기반 중복 감지",
          "status": "completed",
          "assignedDate": "2026-01-03",
          "completedDate": "2026-01-03"
        },
        {
          "id": "task-008",
          "description": "메타데이터 기반 중복 감지",
          "status": "todo",
          "assignedDate": null,
          "completedDate": null
        },
        {
          "id": "task-009",
          "description": "중복 그룹 UI 표시",
          "status": "completed",
          "assignedDate": "2026-01-03",
          "completedDate": "2026-01-03"
        },
        {
          "id": "task-022",
          "description": "Vision pHash 유사 사진 감지",
          "status": "completed",
          "assignedDate": "2026-01-03",
          "completedDate": "2026-01-03"
        }
      ],
      "notes": "SHA256 해시 기반 완전 동일 + Vision pHash 유사 사진 감지 완료. 메타데이터 버킷팅으로 O(n²) 최적화. 대시보드에 중복 카드 섹션 추가"
    },
    {
      "id": "feature-004",
      "name": "사진 제거/수정",
      "description": "선택한 사진을 삭제하거나 문제를 수정",
      "status": "completed",
      "priority": "high",
      "dependencies": ["feature-001", "feature-002"],
      "tasks": [
        {
          "id": "task-010",
          "description": "PHAsset 삭제 요청 구현",
          "status": "completed",
          "assignedDate": "2026-01-02",
          "completedDate": "2026-01-02"
        },
        {
          "id": "task-011",
          "description": "일괄 삭제 기능",
          "status": "completed",
          "assignedDate": "2026-01-02",
          "completedDate": "2026-01-02"
        },
        {
          "id": "task-012",
          "description": "삭제 확인 UI",
          "status": "completed",
          "assignedDate": "2026-01-02",
          "completedDate": "2026-01-02"
        }
      ],
      "notes": "IssueListView에서 다중 선택 및 일괄 삭제 구현. confirmationDialog 사용"
    },
    {
      "id": "feature-005",
      "name": "스크린샷 정리",
      "description": "스크린샷만 모아서 일괄 관리 및 삭제",
      "status": "completed",
      "priority": "high",
      "dependencies": ["feature-001"],
      "tasks": [
        {
          "id": "task-013",
          "description": "스크린샷 감지 (mediaSubtypes.screenshot)",
          "status": "completed",
          "assignedDate": "2026-01-02",
          "completedDate": "2026-01-02"
        },
        {
          "id": "task-014",
          "description": "날짜별 그룹핑 UI",
          "status": "completed",
          "assignedDate": "2026-01-03",
          "completedDate": "2026-01-03"
        },
        {
          "id": "task-015",
          "description": "스마트 필터 (오늘/이번주/오래된것)",
          "status": "completed",
          "assignedDate": "2026-01-03",
          "completedDate": "2026-01-03"
        }
      ],
      "notes": "detectScreenshot + DateFilter 날짜별 필터 UI 구현 완료 (전체/오늘/이번주/이번달/오래된것)"
    },
    {
      "id": "feature-006",
      "name": "대용량 파일 감지",
      "description": "설정된 크기 이상의 파일 감지 및 관리",
      "status": "completed",
      "priority": "medium",
      "dependencies": ["feature-001"],
      "tasks": [
        {
          "id": "task-016",
          "description": "파일 크기 기준 설정 UI",
          "status": "completed",
          "assignedDate": "2026-01-03",
          "completedDate": "2026-01-03"
        },
        {
          "id": "task-017",
          "description": "대용량 파일 스캔 로직",
          "status": "completed",
          "assignedDate": "2026-01-02",
          "completedDate": "2026-01-02"
        },
        {
          "id": "task-018",
          "description": "크기순 정렬 목록 UI",
          "status": "completed",
          "assignedDate": "2026-01-03",
          "completedDate": "2026-01-03"
        }
      ],
      "notes": "LargeFileSizeOption (5/10/25/50/100MB) + largeFileSizeFilterPicker UI + 크기순 내림차순 정렬 구현 완료"
    },
    {
      "id": "feature-007",
      "name": "대시보드 메인 화면",
      "description": "문제 유형별 요약 카드를 보여주는 대시보드 UI",
      "status": "completed",
      "priority": "high",
      "dependencies": ["feature-001"],
      "tasks": [
        {
          "id": "task-019",
          "description": "전체 요약 카드 UI",
          "status": "completed",
          "assignedDate": "2026-01-02",
          "completedDate": "2026-01-02"
        },
        {
          "id": "task-020",
          "description": "문제 유형별 카드 그리드",
          "status": "completed",
          "assignedDate": "2026-01-02",
          "completedDate": "2026-01-02"
        },
        {
          "id": "task-021",
          "description": "중복 사진 요약 카드",
          "status": "completed",
          "assignedDate": "2026-01-03",
          "completedDate": "2026-01-03"
        }
      ],
      "notes": "SummaryCard, IssueCard, DuplicateCard 구현 완료. 중복 그룹 수, 정리 가능 용량 표시"
    },
    {
      "id": "feature-008",
      "name": "설정 화면",
      "description": "앱 설정 화면 - 검사 설정, 표시 설정, 데이터 관리",
      "status": "completed",
      "priority": "medium",
      "dependencies": [],
      "tasks": [
        {
          "id": "task-023",
          "description": "AppSettings 모델 구현 (UserDefaults)",
          "status": "completed",
          "assignedDate": "2026-01-04",
          "completedDate": "2026-01-04"
        },
        {
          "id": "task-024",
          "description": "SettingsView 구현",
          "status": "completed",
          "assignedDate": "2026-01-04",
          "completedDate": "2026-01-04"
        },
        {
          "id": "task-025",
          "description": "대시보드에 설정 진입점 추가",
          "status": "completed",
          "assignedDate": "2026-01-04",
          "completedDate": "2026-01-04"
        }
      ],
      "notes": "AppSettings(@Observable), SettingsView 구현 완료. 검사설정, 표시설정, 데이터 관리, 앱 정보 섹션 포함"
    },
    {
      "id": "feature-009",
      "name": "사진 상세 화면",
      "description": "사진 전체 화면 보기, 메타데이터 표시, 삭제 기능",
      "status": "completed",
      "priority": "high",
      "dependencies": ["feature-001", "feature-002"],
      "tasks": [
        {
          "id": "task-026",
          "description": "PhotoDetailView 구현",
          "status": "completed",
          "assignedDate": "2026-01-04",
          "completedDate": "2026-01-04"
        },
        {
          "id": "task-027",
          "description": "PhotoMetadataSheet 구현",
          "status": "completed",
          "assignedDate": "2026-01-04",
          "completedDate": "2026-01-04"
        },
        {
          "id": "task-028",
          "description": "IssueListView 네비게이션 연결",
          "status": "completed",
          "assignedDate": "2026-01-04",
          "completedDate": "2026-01-04"
        }
      ],
      "notes": "문제 사진 목록에서 탭 시 상세 화면으로 이동. 메타데이터 시트에서 문제 정보 및 사진 정보 표시"
    }
  ],
  "issues": [],
  "designDecisions": [
    {
      "id": "design-001",
      "title": "UI 프레임워크 선택",
      "context": "iOS 앱 개발을 위한 UI 프레임워크 결정",
      "decision": "SwiftUI 사용",
      "alternatives": ["UIKit", "SwiftUI + UIKit 하이브리드"],
      "consequences": "최신 iOS 버전 대상, 선언적 UI, 빠른 개발 가능",
      "date": "2026-01-01",
      "status": "accepted"
    },
    {
      "id": "design-002",
      "title": "동시성 모델",
      "context": "사진 처리 작업의 동시성 관리 방식 결정",
      "decision": "Swift Concurrency (async/await, Actor) 사용",
      "alternatives": ["GCD", "Combine", "Operation Queue"],
      "consequences": "MainActor 격리로 UI 안전성 확보, 코드 가독성 향상",
      "date": "2026-01-01",
      "status": "accepted"
    },
    {
      "id": "design-003",
      "title": "디자인 철학 수립",
      "context": "사용자의 소중한 사진을 다루는 앱으로서 일관된 UX 원칙 필요",
      "decision": "4가지 핵심 가치 정의: 신뢰(Trust), 명료함(Clarity), 효율(Efficiency), 제어력(Control)",
      "alternatives": ["최소주의 디자인", "기능 중심 디자인", "게이미피케이션"],
      "consequences": "사용자 신뢰 확보, 실수로 인한 데이터 손실 방지, 접근성 우선",
      "date": "2026-01-01",
      "status": "accepted"
    },
    {
      "id": "design-004",
      "title": "스캔 서비스 Actor 패턴",
      "context": "동시 스캔 요청 및 캐시 관리의 스레드 안전성 필요",
      "decision": "PhotoScanService를 Actor로 구현",
      "alternatives": ["클래스 + DispatchQueue", "@MainActor 클래스"],
      "consequences": "컴파일 타임 동시성 안전성, 캐시 무결성 보장",
      "date": "2026-01-02",
      "status": "accepted"
    }
  ],
  "architecture": {
    "overview": "SwiftUI 기반 iOS 앱으로, PhotoKit을 통해 사진첩에 접근하고 문제 사진을 감지/처리. MVVM 아키텍처 적용",
    "components": [
      {
        "name": "PhotoCleanerApp",
        "responsibility": "앱 진입점 및 Scene 관리",
        "dependencies": []
      },
      {
        "name": "DashboardView",
        "responsibility": "메인 대시보드 UI - 요약 카드, 문제 유형별 카드 표시",
        "dependencies": ["DashboardViewModel"]
      },
      {
        "name": "DashboardViewModel",
        "responsibility": "대시보드 상태 관리 - 권한, 스캔, 결과 처리",
        "dependencies": ["PhotoPermissionService", "PhotoScanService"]
      },
      {
        "name": "IssueListView",
        "responsibility": "문제 사진 목록 표시 및 선택/삭제 UI",
        "dependencies": ["PhotoIssue"]
      },
      {
        "name": "PhotoDetailView",
        "responsibility": "사진 전체 화면 보기, 메타데이터 표시, 삭제 기능",
        "dependencies": ["PhotoIssue"]
      },
      {
        "name": "PhotoPermissionService",
        "responsibility": "Photos 권한 요청 및 상태 관리 (@MainActor @Observable)",
        "dependencies": []
      },
      {
        "name": "PhotoScanService",
        "responsibility": "사진 스캔 및 문제 감지 (Actor)",
        "dependencies": ["PhotoIssue"]
      },
      {
        "name": "PhotoIssue",
        "responsibility": "문제 사진 데이터 모델 및 관련 타입 정의",
        "dependencies": []
      },
      {
        "name": "DesignTokens",
        "responsibility": "색상, 간격, 타이포그래피, 버튼 스타일 토큰",
        "dependencies": []
      }
    ],
    "dataFlow": "PhotoKit → PhotoScanService (Actor) → DashboardViewModel (@MainActor) → SwiftUI View",
    "diagrams": []
  },
  "conventions": {
    "coding": [
      "Swift API Design Guidelines 준수",
      "Swift Concurrency 사용 (async/await)",
      "MainActor 격리 적용",
      "@Observable 매크로 사용 (iOS 17+)"
    ],
    "naming": [
      "타입: PascalCase",
      "변수/함수: camelCase",
      "상수: camelCase"
    ],
    "fileStructure": "기능별 그룹핑 (Sources/Models, Sources/Services, Sources/Views, Sources/ViewModels)",
    "gitWorkflow": "main 브랜치 기반 개발"
  },
  "environment": {
    "development": {
      "setup": [
        "Xcode 26.2 이상 설치",
        "프로젝트 클론",
        "PhotoCleaner.xcodeproj 열기"
      ],
      "commands": {
        "build": "xcodebuild -project PhotoCleaner.xcodeproj -scheme PhotoCleaner",
        "test": "xcodebuild test -project PhotoCleaner.xcodeproj -scheme PhotoCleaner -destination 'platform=iOS Simulator'",
        "run": "Xcode에서 Run (Cmd+R)"
      }
    },
    "variables": []
  },
  "changelog": [
    {
      "date": "2026-01-01",
      "version": "0.0.1",
      "changes": [
        "프로젝트 초기 생성",
        ".gitignore 추가",
        "project.json 생성",
        "DESIGN_PHILOSOPHY.md 생성 - 앱 디자인 철학 문서화",
        "UI_DESIGN_PRINCIPLES.md 생성 - UI 디자인 원칙",
        "DESIGN_VOCABULARY.md 생성 - 디자인 공통 언어",
        "DesignTokens.swift 생성 - 색상, 크기, 폰트 토큰 시스템"
      ]
    },
    {
      "date": "2026-01-02",
      "version": "0.0.2",
      "changes": [
        "FEATURE_SPEC.md 생성 - 전체 기능 명세서",
        "대시보드형 메인 화면 기획",
        "4가지 문제 유형 정의 (iCloud실패, 손상, 스크린샷, 대용량)",
        "중복 사진 감지 모드 결정 (완전동일 + 유사사진)",
        "iOS 26+ 타겟 결정",
        "3단계 구현 로드맵 수립 (MVP → 확장 → 고급)"
      ]
    },
    {
      "date": "2026-01-02",
      "version": "0.1.0",
      "changes": [
        "Phase 1 MVP 구현 완료",
        "PhotoPermissionService 구현 - 권한 요청 및 상태 관리",
        "PhotoScanService 구현 (Actor) - 4가지 문제 유형 감지",
        "PhotoIssue 모델 및 관련 타입 정의",
        "DashboardView 구현 - SummaryCard, IssueCard, 상태별 화면",
        "DashboardViewModel 구현 - @Observable 기반 상태 관리",
        "IssueListView 구현 - 문제 사진 그리드, 다중 선택, 삭제",
        "PhotoThumbnailView 구현 - 비동기 썸네일 로딩"
      ]
    },
    {
      "date": "2026-01-03",
      "version": "0.2.0",
      "changes": [
        "중복 사진 감지 기능 구현 (Phase 1 - 완전 동일)",
        "SHA256 해시 기반 스트리밍 중복 감지 (CryptoKit)",
        "원본 자동 선택 로직 (해상도 > 파일크기 > 생성일)",
        "DuplicateGroup 모델 활용 및 ScanResult 확장",
        "대시보드에 중복 사진 카드 섹션 추가",
        "DuplicateDetectionTests 테스트 케이스 추가"
      ]
    },
    {
      "date": "2026-01-03",
      "version": "0.3.0",
      "changes": [
        "PR #5 머지 - 사진 스캔 기능 강화",
        "Vision pHash 기반 유사 사진 감지 (VNGenerateImageFeaturePrintRequest)",
        "메타데이터 버킷팅으로 유사 사진 비교 O(n²) 최적화",
        "LargeFileSizeOption enum (5/10/25/50/100MB 선택)",
        "대용량 파일 크기 설정 UI (largeFileSizeFilterPicker)",
        "대용량 파일 크기순 내림차순 정렬",
        "스크린샷 DateFilter (전체/오늘/이번주/이번달/오래된것)",
        "Actor 프로퍼티 동기 접근 제거 - ViewModel 자체 상태 관리",
        "Vision perform() 블로킹 → DispatchQueue.global 분리",
        "Continuation 다중 resume 방지 - NSLock + isDegraded 체크",
        "AGENTS.md 생성 - 빌드/테스트 명령어, 코드 스타일 가이드"
      ]
    },
    {
      "date": "2026-01-03",
      "version": "0.3.1",
      "changes": [
        "AllPhotosView - 전체 사진 그리드 UI",
        "AssetThumbnailView - PHAsset 썸네일 컴포넌트",
        "대시보드에서 전체 사진 진입점 추가"
      ]
    },
    {
      "date": "2026-01-04",
      "version": "0.4.0",
      "changes": [
        "설정 화면 구현 (feature-008)",
        "AppSettings 모델 - UserDefaults 연동",
        "SettingsView - 검사/표시/데이터 설정",
        "대시보드 네비게이션 바에 설정 버튼 추가",
        "DuplicateDetectionMode, SimilarityThreshold, ThumbnailSize, SortOrder enum 추가",
        "DashboardViewModel.clearCache() 메서드 추가"
      ]
    },
    {
      "date": "2026-01-04",
      "version": "0.5.0",
      "changes": [
        "사진 상세 화면 구현 (feature-009)",
        "PhotoDetailView - 전체 화면 사진 보기 및 삭제",
        "PhotoMetadataSheet - 문제 정보 및 사진 메타데이터 표시",
        "IssueListView에서 상세 화면 네비게이션 연결"
      ]
    }
  ],
  "references": [
    {
      "title": "PhotoKit Documentation",
      "url": "https://developer.apple.com/documentation/photokit",
      "description": "Apple 공식 PhotoKit 프레임워크 문서"
    },
    {
      "title": "PHAsset",
      "url": "https://developer.apple.com/documentation/photokit/phasset",
      "description": "사진/비디오 에셋 표현 클래스"
    },
    {
      "title": "Design Philosophy",
      "url": "DESIGN_PHILOSOPHY.md",
      "description": "PhotoCleaner 앱 디자인 철학 문서 - 핵심 가치, 시각 디자인, 인터랙션 패턴, 접근성"
    },
    {
      "title": "UI Design Principles",
      "url": "UI_DESIGN_PRINCIPLES.md",
      "description": "레이아웃, 시각적 계층, 일관성, 반응형 디자인 가이드"
    },
    {
      "title": "Design Vocabulary",
      "url": "DESIGN_VOCABULARY.md",
      "description": "앱 전반의 공통 용어 정의 - 사진 관련, 문제 유형, 액션, 상태"
    },
    {
      "title": "Design Tokens",
      "url": "PhotoCleaner/Sources/DesignSystem/DesignTokens.swift",
      "description": "SwiftUI 디자인 토큰 - 색상, 간격, 타이포그래피, 버튼 스타일"
    },
    {
      "title": "Feature Specification",
      "url": "FEATURE_SPEC.md",
      "description": "전체 기능 명세서 - 화면 구조, 기능 상세, 데이터 모델, 구현 로드맵"
    }
  ]
}
